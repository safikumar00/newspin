<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spin_wheel</title>
    <link rel="stylesheet" href="./assests/bootstrap.min.css">
    <link rel="stylesheet" href="./style.css">
</head>


<body class="flex-column">

    <audio id="myAudio" src="./assests/spin_audio.mp3" type="audio/mp3"></audio>
    <audio id="coins_audio" src="./assests/Coins_count.mp3" type="audio/mp3"></audio>
    <audio id="crowd_cheering" src="./assests/crowd_cheering.mp3" type="audio/mp3"></audio>
    <audio id="winner_cheer" src="./assests/winner_cheers.mp3" type="audio/mp3"></audio>

    <div id="box" class="box d-flex align-items-center flex-column">
        <img src="./assests/title.webp" alt="" class="title">
        <!-- <img src="./assests/tag.webp" alt="" class="tag mt-2"> -->
        <div id="wheel" class="wheel d-flex justify-content-center align-items-center mt-2">
            <img src="./assests/wheel.webp" alt="" class="wheel_img" id="wheel_img">
            <div id="spin_button" class="spin_button">
                <img src="./assests/spin.webp" alt="spin">
            </div>
            <!-- <div id="pointer" class="pointer">
                <div id="dot" class="dot"></div>
            </div> -->
            <img src="./assests/hand.webp" class="hand" alt="">
        </div>
        <!-- <img src="./assests/made.webp" alt="" class="made"> -->
        <!-- <div id="sentence" class="sentence gap-2 d-flex justify-content-center align-items-center flex-column">
            <div id="icon1" class="icon d-flex align-items-center justify-content-center flex-row">
                <img src="./assests/tick.webp" alt="">
                <p class="mb-0">UPI Transaction</p>
            </div>

            <div id="icon2" class="icon d-flex align-items-center justify-content-center flex-row">
                <img src="./assests/tick.webp" alt="">
                <p class="mb-0">100% Guarantee</p>
            </div>
        </div> -->

        <div class="marqee">
            <p style="text-align: center; color: white;">Winner's List</p>
            <marquee behavior="smooth" direction="up"
                style="font-size: 12px; color: white; height: 40px; text-align: center;" class="mt-10" scrollamount="2">
                <p>+91 950** ***** has won Rs.9500/-</p>

                <p>+91 550** ***** has won Rs.3000/-</p>

                <p>+91 300** ***** has won Rs.5500/-</p>

                <p>+91 700** ***** has won Rs.9500/-</p>

                <p>+91 800** ***** has won Rs.3000/-</p>

                <p>+91 550** ***** has won Rs.9500/-</p>

                <p>+91 950** ***** has won Rs.5500/-</p>

                <p>+91 300** ***** has won Rs.9500/-</p>

                <p>+91 700** ***** has won Rs.3000/-</p>

                <p>+91 800** ***** has won Rs.9500/-</p>

                <p>+91 550** ***** has won Rs.5500/-</p>

                <p>+91 950** ***** has won Rs.9500/-</p>

                <p>+91 300** ***** has won Rs.5500/-</p>

                <p>+91 700** ***** has won Rs.3000/-</p>

                <p>+91 800** ***** has won Rs.9500/-</p>

                <p>+91 550** ***** has won Rs.3000/-</p>

                <p>+91 950** ***** has won Rs.9500/-</p>

                <p>+91 300** ***** has won Rs.9500/-</p>

                <p>+91 700** ***** has won Rs.5500/-</p>

                <p>+91 800** ***** has won Rs.9500/-</p>

                <p>+91 550** ***** has won Rs.9500/-</p>

                <p>+91 950** ***** has won Rs.5500/-</p>

                <p>+91 300** ***** has won Rs.9500/-</p>

                <p>+91 700** ***** has won Rs.3000/-</p>

                <p>+91 800** ***** has won Rs.5500/-</p>

                <p>+91 550** ***** has won Rs.9500/-</p>

                <p>+91 950** ***** has won Rs.3000/-</p>

                <p>+91 300** ***** has won Rs.9500/-</p>

                <p>+91 700** ***** has won Rs.5500/-</p>

                <p>+91 800** ***** has won Rs.3000/-</p>

                <p>+91 550** ***** has won Rs.9500/-</p>

                <p>+91 950** ***** has won Rs.5500/-</p>

                <p>+91 300** ***** has won Rs.9500/-</p>

            </marquee>
        </div>
    </div>

    <div id="retry_popup" class="retry_popup">
        <!-- <div id="retry" class="retry d-flex flex-column"> -->
        <!-- <div id="close" class="close">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                    class="bi bi-x-circle-fill" viewBox="0 0 16 16">
                    <path
                        d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z" />
                </svg>
            </div> -->
        <div class="d-flex justify-content-center align-items-center">
            <img src="./assests/dull.webp" alt="" style="width: 75%;">
        </div>
        <!-- </div> -->
        <div class="retry_icon d-flex  align-items-center flex-row heartbeat justify-content-center" id="retry_button">
            <img src="./assests/retry.webp" alt="">
        </div>
    </div>

    <div id="final_popup" class="final_popup">
        <canvas id="canvas"></canvas>
        <!-- <h1 class="congrats" style="text-align: center;"><i>HURRAY ! CONGRATULATIONS !</i></h1> -->
        <!-- <p class="mt-10">Just click on <strong>Claim Now</strong> to receive the deal.</p> -->
        <div class="popup-con ">
            <!-- <img src="./assets/new/giftbox.webp   " width="80px" class="coin_bag"> -->
            <div>
                <img src="./assests/image_3.webp" alt="" width="100%" style="margin-bottom: 10px;">
            </div>

            <div class="time mt-5">
                <h2 class="mb-4" id="heading" style="color: red; font-size: 14px; ">Limited Time
                    Offer Remaining</h2>
                <div class="timer-container" id="timer" style="font-size: 16px; font-weight: 600;">
                    <div id="hours" class="timer-box">00</div>
                    <div class="dots">:</div>
                    <div id="minutes" class="timer-box">01</div>
                    <div class="dots">:</div>
                    <div id="seconds" class="timer-box">30</div>
                </div>
            </div>

            <a href="https://www.google.com" target="_blank"><button class="claim-amount mt-20 pulsate-bck"
                    type="button" style="width: 70%;">Withdraw Now</button></a>

            <p class="mt-10" style="font-size: 12px;">Hurry up! Valid for few minutes only.</p>
        </div>

        <!-- <div class="sub-heading-offer">
            <div class="valid_time"
                style="display: flex; align-items: center; justify-content: center; flex-direction: column; font-size: 16px;">
                <p>Offer Valid Till</p>
                <div id="timer" style="font-weight: 600; margin-top: 5px;"></div>
            </div>
        </div> -->
        <div class="steps">
            <h2 class="steps-title">Steps To Claim The Offer</h2>
            <p><span>Step 1</span>Download</p>
            <p><span>Step 2</span>Install</p>
            <p><span>Step 3</span>Register</p>
        </div>

    </div>

</body>


<script>
    // -----------------------------
    // GLOBAL CONFIGURATION & VARIABLES
    // -----------------------------
    const spinDuration = 4000;  // Duration (ms) for the spin animation
    const finalPopupDelay = 500; // Additional delay (ms) before the final popup appears
    let isFirstSpin = true;     // Track if it's the first spin

    // Retrieve URL parameter (e.g., ?id=15000)
    const urlParams = new URLSearchParams(window.location.search);
    let spinParam = urlParams.get('id');

    // Debug: Check URL parameter
    console.log('URL parameter (id):', spinParam);

    // -----------------------------
    // EVENT LISTENER FOR SPIN BUTTON
    // -----------------------------
    document.getElementById('spin_button').addEventListener('click', () => {
        console.log('Spin button clicked');

        const wheel = document.getElementById('wheel_img');  // The spinning wheel image element
        const spinAudio = document.getElementById('myAudio');  // Sound for spinning
        const handElement = document.querySelector('.hand');  // Hand indicator

        // Debug: Check if wheel and audio exist
        if (!wheel) console.error('Wheel element not found!');
        if (!spinAudio) console.error('Spin audio element not found!');

        // Play the spin sound
        spinAudio.play();

        // Hide hand element
        if (handElement) {
            handElement.style.display = 'none';
            console.log('Hand element hidden');
        }

        // Remove any auto-rotation class if present
        wheel.classList.remove('auto-rotate');

        // Trigger mobile vibration with improved logic
        function startVibration() {
            if ('vibrate' in navigator) {
                console.log('Vibration API supported');
                navigator.vibrate([200, 100, 200]); // Initial vibration burst

                let vibrationInterval = setInterval(() => {
                    navigator.vibrate([100, 50, 100]); // Continuous effect
                    console.log('Vibration triggered during spin');
                }, 500);

                // Stop vibration after spinDuration
                setTimeout(() => {
                    clearInterval(vibrationInterval);
                    console.log('Vibration stopped after spin completion');
                }, spinDuration);
            } else {
                console.warn('Vibration API not supported on this device');
            }
        }

        let degree;  // This value will hold the target rotation angle

        if (isFirstSpin) {
            console.log('First spin logic activated');
            degree = 3632;  // First spin always rotates to the bomb angle
            isFirstSpin = false;

            wheel.style.transition = "transform 4s ease-out";
            wheel.style.transform = `rotate(${degree}deg)`;

            startVibration(); // Activate vibration feedback

            setTimeout(() => {
                console.log('First spin completed: Wheel stopped at bomb angle');

                document.getElementById('retry_button').addEventListener('click', () => {
                    console.log('Retry button clicked');

                    const handElement = document.querySelector('.hand');
                    if (handElement) {
                        handElement.style.display = 'block';
                        console.log('Hand element displayed again');
                    }
                });

                // Hide the spin-wheel container
                const box = document.querySelector('.box');
                if (box) box.style.display = 'none';

                // Display the retry popup
                const retryPopup = document.getElementById('retry_popup');
                if (retryPopup) retryPopup.style.display = 'flex';

                // Play sound for the retry popup
                const coinsAudio = document.getElementById('coins_audio');
                if (coinsAudio) coinsAudio.play();
            }, spinDuration);
        } else {
            console.log('Second spin logic activated');

            if (spinParam === '5500') {
                degree = 3449;
            } else if (spinParam === '9500') {
                degree = 3571;
            } else if (spinParam === '3500') {
                degree = 3690;
            } else {
                degree = 3449;
                spinParam = '5500';
            }

            console.log('Degree of rotation:', degree);

            wheel.style.transition = "transform 4s ease-out";
            wheel.style.transform = `rotate(${degree}deg)`;

            startVibration(); // Activate vibration feedback

            setTimeout(() => {
                console.log(`Second spin completed: Wheel stopped at prize ID: ${spinParam}`);

                setTimeout(() => {
                    const timer = document.getElementById('timer');
                    const hours = document.getElementById('hours');
                    const minutes = document.getElementById('minutes');
                    const seconds = document.getElementById('seconds');

                    let timeLeft = 90;
                    const countdown = setInterval(() => {
                        if (timeLeft > 0) {
                            timeLeft--;
                            hours.textContent = Math.floor(timeLeft / 3600).toString().padStart(2, '0');
                            minutes.textContent = Math.floor((timeLeft % 3600) / 60).toString().padStart(2, '0');
                            seconds.textContent = (timeLeft % 60).toString().padStart(2, '0');
                        } else {
                            clearInterval(countdown);
                        }
                    }, 1000);

                    const finalPopup = document.getElementById('final_popup');
                    if (finalPopup) {
                        finalPopup.style.display = 'flex';
                        console.log('Final popup displayed');
                    }

                    const winnerCheerAudio = document.getElementById('winner_cheer');
                    if (winnerCheerAudio) {
                        winnerCheerAudio.play();
                        console.log('Winner cheer audio played');
                    }
                }, finalPopupDelay);
            }, spinDuration);
        }
    });

    // -----------------------------
    // RETRY POPUP BUTTONS
    // -----------------------------
    document.getElementById('retry_button').addEventListener('click', () => {
        console.log('Retry button clicked');

        const retryPopup = document.getElementById('retry_popup');
        if (retryPopup) {
            retryPopup.style.display = 'none';
            console.log('Retry popup hidden');
        }

        const wheel = document.getElementById('wheel_img');
        if (wheel) {
            wheel.style.transition = "none";
            wheel.style.transform = "rotate(0deg)";
            console.log('Wheel reset for next spin');
        }

        const box = document.querySelector('.box');
        if (box) {
            box.style.display = 'flex';
            console.log('Spin wheel container displayed');
        }
    });

</script>


<script>
    let W = window.innerWidth;
    let H = window.innerHeight;
    const canvas = document.getElementById("canvas");
    const context = canvas.getContext("2d");
    const maxConfettis = 10;
    const particles = [];

    const possibleColors = [
        "DodgerBlue",
        "OliveDrab",
        "Gold",
        "Pink",
        "SlateBlue",
        "LightBlue",
        "Gold",
        "Violet",
        "PaleGreen",
        "SteelBlue",
        "SandyBrown",
        "Chocolate",
        "Crimson"
    ];

    function randomFromTo(from, to) {
        return Math.floor(Math.random() * (to - from + 1) + from);
    }

    function confettiParticle() {
        this.x = Math.random() * W; // x
        this.y = Math.random() * H - H; // y
        this.r = randomFromTo(11, 33); // radius
        this.d = Math.random() * maxConfettis + 11;
        this.color =
            possibleColors[Math.floor(Math.random() * possibleColors.length)];
        this.tilt = Math.floor(Math.random() * 33) - 11;
        this.tiltAngleIncremental = Math.random() * 0.07 + 0.05;
        this.tiltAngle = 0;

        this.draw = function () {
            context.beginPath();
            context.lineWidth = this.r / 2;
            context.strokeStyle = this.color;
            context.moveTo(this.x + this.tilt + this.r / 3, this.y);
            context.lineTo(this.x + this.tilt, this.y + this.tilt + this.r / 5);
            return context.stroke();
        };
    }

    function Draw() {
        const results = [];

        // Magical recursive functional love
        requestAnimationFrame(Draw);

        context.clearRect(0, 0, W, window.innerHeight);

        for (var i = 0; i < maxConfettis; i++) {
            results.push(particles[i].draw());
        }

        let particle = {};
        let remainingFlakes = 0;
        for (var i = 0; i < maxConfettis; i++) {
            particle = particles[i];

            particle.tiltAngle += particle.tiltAngleIncremental;
            particle.y += (Math.cos(particle.d) + 3 + particle.r / 2) / 2;
            particle.tilt = Math.sin(particle.tiltAngle - i / 3) * 15;

            if (particle.y <= H) remainingFlakes++;

            // If a confetti has fluttered out of view,
            // bring it back to above the viewport and let if re-fall.
            if (particle.x > W + 30 || particle.x < -30 || particle.y > H) {
                particle.x = Math.random() * W;
                particle.y = -30;
                particle.tilt = Math.floor(Math.random() * 10) - 20;
            }
        }

        return results;
    }

    window.addEventListener(
        "resize",
        function () {
            W = window.innerWidth;
            H = window.innerHeight;
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        },
        false
    );

    // Push new confetti objects to particles[]
    for (var i = 0; i < maxConfettis; i++) {
        particles.push(new confettiParticle());
    }

    // Initialize
    canvas.width = W;
    canvas.height = H;
    Draw();
</script>



</html>